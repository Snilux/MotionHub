---
import Layout from "../layouts/Layout.astro";
import Nav from "../components/home/Nav.astro";
import Hero from "../components/home/Hero.astro";
import Info from "../components/home/Info.astro";
import FunctionsHistorial from "../components/home/FunctionsHistorial.astro";
import FunctionsSmartAgenda from "../components/home/FunctionsSmartAgenda.astro";
import FunctionsTotalAdministration from "../components/home/FunctionsTotalAdministration.astro";
import CallToAction from "../components/home/CallToAction.astro";
import FinalCTA from "../components/home/FinalCTA.astro";
import Footer from "../components/common/Footer.astro";
---

<Layout title="MotionHub">
    <Nav />
    <div class="snap-section" data-section="hero">
        <Hero />
    </div>
    <div class="snap-section" data-section="info">
        <Info />
    </div>
    <div class="snap-section" data-section="historial">
        <FunctionsHistorial />
    </div>
    <div class="snap-section" data-section="agenda">
        <FunctionsSmartAgenda />
    </div>
    <div class="snap-section" data-section="administration">
        <FunctionsTotalAdministration />
    </div>
    <div class="snap-section" data-section="cta">
        <CallToAction />
    </div>
    <div class="snap-section" data-section="final">
        <FinalCTA />
    </div>
    <div class="snap-section" data-section="footer">
        <Footer />
    </div>
</Layout>

<script>
    import { gsap } from "gsap";
    import { ScrollTrigger } from "gsap/ScrollTrigger";

    gsap.registerPlugin(ScrollTrigger);

    document.addEventListener("DOMContentLoaded", () => {
        const sections = document.querySelectorAll(".snap-section");

        sections.forEach((section, index) => {
            const texts = section.querySelectorAll("h1, h2, h3, p");
            if (texts.length > 0) {
                gsap.from(texts, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    y: 50,
                    opacity: 0,
                    duration: 0.8,
                    stagger: 0.2,
                    ease: "power2.out",
                });
            }

            const images = section.querySelectorAll("img");
            if (images.length > 0) {
                gsap.from(images, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    scale: 0.8,
                    opacity: 0,
                    duration: 1,
                    ease: "power2.out",
                });
            }

            const links = section.querySelectorAll("a");
            if (links.length > 0) {
                gsap.from(links, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    y: 30,
                    opacity: 0,
                    duration: 0.6,
                    delay: 0.4,
                    ease: "power2.out",
                });
            }

            const cards = section.querySelectorAll(".glass-card");
            if (cards.length > 0) {
                gsap.from(cards, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    y: 60,
                    opacity: 0,
                    duration: 0.8,
                    stagger: 0.15,
                    ease: "power3.out",
                });
            }

            const icons = section.querySelectorAll("[class*='shadow-lg']");
            if (icons.length > 0) {
                gsap.from(icons, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    scale: 0.5,
                    opacity: 0,
                    duration: 0.6,
                    stagger: 0.1,
                    ease: "back.out(1.7)",
                });
            }

            const featureItems = section.querySelectorAll(".feature-item");
            if (featureItems.length > 0) {
                gsap.from(featureItems, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    x: -100, 
                    opacity: 0,
                    duration: 0.7,
                    stagger: 0.30, 
                    ease: "power2.out",
                });
            }

            const otherListItems = section.querySelectorAll(
                "li:not(.feature-item)",
            );
            if (otherListItems.length > 0) {
                gsap.from(otherListItems, {
                    scrollTrigger: {
                        trigger: section,
                        start: "top 80%",
                        end: "top 20%",
                        toggleActions: "play none none none",
                    },
                    y: 40,
                    opacity: 0,
                    duration: 0.6,
                    stagger: 0.1,
                    ease: "power2.out",
                });
            }
        });

        const heroSection = document.querySelector('[data-section="hero"]');
        if (heroSection) {
            const heroTitles = heroSection.querySelectorAll("h1, h2");
            const heroContent = heroSection.querySelectorAll("p, a");

            gsap.set(heroTitles, { y: 100, opacity: 0 });
            gsap.set(heroContent, { y: 50, opacity: 0 });

            gsap.to(heroTitles, {
                y: 0,
                opacity: 1,
                duration: 1.2,
                stagger: 0.3,
                ease: "power3.out",
                delay: 0.2,
            });

            gsap.to(heroContent, {
                y: 0,
                opacity: 1,
                duration: 0.8,
                stagger: 0.2,
                ease: "power2.out",
                delay: 0.8,
            });
        }
    });
</script>
